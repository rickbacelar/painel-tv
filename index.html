<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Painel de Resultados - MC Soluções</title>
<style>
:root{
  --orange:#FF6B00;
  --dark:#2E2E2E;
  --bg:#F5F5F6;
  --card:#FFFFFF;
  --muted:#8A8A8A;
}
*{box-sizing:border-box;margin:0;padding:0;}
html,body{height:100%;font-family:Inter,system-ui,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--dark);}
.app{display:flex;flex-direction:column;height:100%;}
header{
  background:linear-gradient(90deg,var(--dark) 0%, #3C3C3C 100%);
  color:white;
  padding:30px 50px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  box-shadow:0 4px 12px rgba(0,0,0,0.3);
}

.header-title{display:flex;align-items:center;gap:30px;font-weight:900;font-size:48px;letter-spacing:1px;}
.logo-dot{width:30px;height:30px;border-radius:4px;background:var(--orange);box-shadow:0 4px 12px rgba(255,107,0,0.5);}
.logo-img{height:150px;width:auto;object-fit:contain;background:#fff;border-radius:6px;padding:6px;box-shadow:0 0 12px rgba(0,0,0,0.2);}
.main{
  flex:1;
  display:grid;
  justify-items:center;
  align-items:center;
  gap:30px;
  padding:30px;
}
.card{
  background:var(--card);
  border-radius:24px;
  padding:60px 40px;
  min-height:400px;
  box-shadow:0 12px 25px rgba(0,0,0,0.12);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  border-top:8px solid var(--orange);
  transition:transform 0.3s ease,box-shadow 0.3s ease;
}
.title{font-size:4rem;color:var(--dark);font-weight:900;margin-bottom:30px;text-transform:uppercase;letter-spacing:1.5px;}
.info{display:flex;flex-direction:column;gap:20px;font-size:2.5rem;font-weight:700;color:var(--dark);}
.info strong{color:var(--orange);}
.footer{
  padding:25px 50px;
  text-align:center;
  color:var(--muted);
  font-size:22px;
  background:#EFEFEF;
  border-top:2px solid var(--orange);
  font-weight:700;
  letter-spacing:0.5px;
}
.center{display:flex;align-items:center;justify-content:center;height:100%;font-size:3rem;color:var(--dark);}

/* === DESTAQUE DA SEMANA === */
.destaque-semana{
  display:flex;
  align-items:center;
  justify-content:center;
  height:100%;
  text-align:center;
  animation:fadeIn 1.5s ease;
  max-height:100vh;
  overflow:hidden;
}

.destaque-card{
  background: linear-gradient(135deg, var(--orange) 0%, #ff9330 100%);
  border-radius:40px;
  padding:40px 60px;
  color:white;
  box-shadow:0 0 30px rgba(0,0,0,0.3);
  animation: brilhar 2s infinite alternate;
  max-height:90vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}

.foto-destaque{
  width:280px;
  height:280px;
  object-fit:cover;
  border-radius:50%;
  border:8px solid white;
  margin:25px 0;
  box-shadow:0 0 25px rgba(255,255,255,0.6);
}

.foto-monitoria {
    width: 95vw;
    height: 85vh;
    object-fit: contain;
}

.estrelas{
  font-size:2.4rem;
  color:gold;
  text-shadow:0 0 10px rgba(255,255,255,0.8);
  margin-bottom:8px;
}

.destaque-card h1{
  font-size:3rem;
  margin-bottom:15px;
  text-shadow:0 3px 10px rgba(0,0,0,0.3);
}

.destaque-card h2{
  font-size:2.5rem;
  margin-bottom:15px;
}

.destaque-card p{
  font-size:1.7rem;
  margin-top:10px;
  font-weight:600;
  max-width:90%;
  margin-left:auto;
  margin-right:auto;
  line-height:1.4;
}

/* grid fotos monitoria */
.photo-grid{
  width:100%;
  display:grid;
  gap:18px;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  align-items:start;
  padding:20px;
  box-sizing:border-box;
}
.photo-card{
  border-radius:18px;
  overflow:hidden;
  background:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  min-height: 500px;
  height: 70vh;
  box-shadow:0 8px 20px rgba(0,0,0,0.08);
}
.photo-card img{ width:100%; height:100%; object-fit:cover; display:block; }

/* efeito de clique */
body:active {
  opacity: 0.85;
  transition: opacity 0.15s;
}
</style>
</head>

<body>
<div class="app">

  <!-- HEADER -->
  <header>
    <div class="header-title">
      <img src="logo.png" class="logo-img">
      <div class="logo-dot"></div>
      <div>Painel de Resultados</div>
    </div>
  </header>

  <!-- CONTEÚDO PRINCIPAL -->
  <div class="main" id="main-content">
    <div class="center" id="loading-indicator">Carregando dados...</div>
  </div>

  <!-- RODAPÉ -->
  <div class="footer">MC Soluções ©</div>
</div>

<script>
// ==========================
// CONFIGURAÇÕES
// ==========================
const DESTAQUE_FOTOS_URL =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZt529CoSQvc13l8kopidVIRoEMCHSLFy9A-xJ9Ij440qac25VRLjDjPpskRPBOA/pub?gid=1257542704&single=true&output=csv";

const PAGE_DURATION = 30000; // 30 segundos por página

// ==========================
// ARRAYS DE FOTOS
// ==========================
let monitoriaFotos = {
  foto_monitoria1: [],
  foto_monitoria2: [],
  foto_monitoria3: [],
  foto_monitoria4: []   // <-- NOVA FOTO ADICIONADA
};


// ==========================
// FUNÇÕES CSV
// ==========================
function parseCSV(text){
  const rows = [];
  let cur="", row=[], q=false;

  for(let i=0;i<text.length;i++){
    const c=text[i];

    if(c=='"'){
      if(q && text[i+1]=='"'){ cur+='"'; i++; }
      else q=!q;
      continue;
    }

    if(!q && c==','){ row.push(cur); cur=""; continue; }

    if(!q && (c=='\n'||c=='\r')){
      if(cur!==""||row.length){ row.push(cur); rows.push(row); }
      cur=""; row=[];
      if(c=='\r' && text[i+1]=='\n') i++;
      continue;
    }

    cur+=c;
  }

  if(cur!==""||row.length){ row.push(cur); rows.push(row); }

  return rows;
}

async function fetchAndParse(url){
  const res = await fetch(url + "&nocache=" + Date.now());
  const text = await res.text();
  return parseCSV(text);
}

function normalize(s){
  return s ? String(s).toLowerCase().trim() : "";
}


// ==========================
// NORMALIZAR LINK GOOGLE DRIVE
// ==========================
function normalizeDriveLink(url){
  if(!url) return "";

  if(url.includes("drive.google.com")){
    const id = url.match(/[-\w]{25,}/);
    if(id) return "https://drive.google.com/uc?id=" + id[0];
  }

  return url;
}


// ==========================
// CRIA GRID DE FOTOS
// ==========================
function createPhotoGrid(list){
  const grid = document.createElement("div");
  grid.className = "photo-grid";

  list.forEach(url=>{
    if(!url) return;

    url = normalizeDriveLink(url);
    url += (url.includes("?") ? "&" : "?") + "t=" + Date.now();

    const card = document.createElement("div");
    card.className = "photo-card";

    const img = document.createElement("img");
    img.src = url;

    card.appendChild(img);
    grid.appendChild(card);
  });

  return grid;
}


// ==========================
// PÁGINAS DO PAINEL
// ==========================
let pages = [];
let currentPage = 0;

function preparePages(){
  pages = [];

  pages.push([ createPhotoGrid(monitoriaFotos.foto_monitoria1) ]);
  pages.push([ createPhotoGrid(monitoriaFotos.foto_monitoria2) ]);
  pages.push([ createPhotoGrid(monitoriaFotos.foto_monitoria3) ]);

  // === NOVA PÁGINA ADICIONADA ===
  pages.push([ createPhotoGrid(monitoriaFotos.foto_monitoria4) ]);
}

function showPage(i){
  currentPage = i;
  const main = document.getElementById("main-content");
  main.innerHTML = "";
  main.style.gridTemplateColumns = "1fr";

  const content = pages[i];
  content.forEach(el => main.appendChild(el));
}

function nextPage(){
  showPage((currentPage + 1) % pages.length);
}


// ==========================
// CARREGAR DADOS DA PLANILHA
// ==========================
async function loadAll(){
  const rows = await fetchAndParse(DESTAQUE_FOTOS_URL);

  if(rows && rows.length > 0){
    const headers = rows[0].map(h => normalize(h));

    const idx1 = headers.indexOf("foto_monitoria1");
    const idx2 = headers.indexOf("foto_monitoria2");
    const idx3 = headers.indexOf("foto_monitoria3");
    const idx4 = headers.indexOf("foto_monitoria4"); // <-- NOVO

    for(let i=1; i<rows.length; i++){
      const r = rows[i];

      if(idx1!=-1 && r[idx1]) monitoriaFotos.foto_monitoria1.push(r[idx1]);
      if(idx2!=-1 && r[idx2]) monitoriaFotos.foto_monitoria2.push(r[idx2]);
      if(idx3!=-1 && r[idx3]) monitoriaFotos.foto_monitoria3.push(r[idx3]);
      if(idx4!=-1 && r[idx4]) monitoriaFotos.foto_monitoria4.push(r[idx4]); // <-- NOVO
    }
  }

  document.getElementById("loading-indicator").style.display = "none";

  preparePages();
  showPage(0);

  setInterval(nextPage, PAGE_DURATION);
}

loadAll();
</script>
</body>
</html>
