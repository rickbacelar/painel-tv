<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Painel de Resultados - MC Solu√ß√µes</title>
<style>
:root{
  --orange:#FF6B00;
  --dark:#2E2E2E;
  --bg:#F5F5F6;
  --card:#FFFFFF;
  --muted:#8A8A8A;
}
*{box-sizing:border-box;margin:0;padding:0;}
html,body{height:100%;font-family:Inter,system-ui,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--dark);}
.app{display:flex;flex-direction:column;height:100%;}
header{
  background:linear-gradient(90deg,var(--dark) 0%, #3C3C3C 100%);
  color:white;
  padding:30px 50px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  box-shadow:0 4px 12px rgba(0,0,0,0.3);
}

.header-title{display:flex;align-items:center;gap:30px;font-weight:900;font-size:48px;letter-spacing:1px;}
.logo-dot{width:30px;height:30px;border-radius:4px;background:var(--orange);box-shadow:0 4px 12px rgba(255,107,0,0.5);}
.logo-img{height:150px;width:auto;object-fit:contain;background:#fff;border-radius:6px;padding:6px;box-shadow:0 0 12px rgba(0,0,0,0.2);}
.main{
  flex:1;
  display:grid;
  justify-items:center;
  align-items:center;
  gap:30px;
  padding:30px;
}
.card{
  background:var(--card);
  border-radius:24px;
  padding:60px 40px;
  min-height:400px;
  box-shadow:0 12px 25px rgba(0,0,0,0.12);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  border-top:8px solid var(--orange);
  transition:transform 0.3s ease,box-shadow 0.3s ease;
}
.title{font-size:4rem;color:var(--dark);font-weight:900;margin-bottom:30px;text-transform:uppercase;letter-spacing:1.5px;}
.info{display:flex;flex-direction:column;gap:20px;font-size:2.5rem;font-weight:700;color:var(--dark);}
.info strong{color:var(--orange);}
.footer{
  padding:25px 50px;
  text-align:center;
  color:var(--muted);
  font-size:22px;
  background:#EFEFEF;
  border-top:2px solid var(--orange);
  font-weight:700;
  letter-spacing:0.5px;
}
.center{display:flex;align-items:center;justify-content:center;height:100%;font-size:3rem;color:var(--dark);}

/* === DESTAQUE DA SEMANA COBRAN√áA === */
.destaque-semana{
  display:flex;
  align-items:center;
  justify-content:center;
  height:100%;
  text-align:center;
  animation:fadeIn 1.5s ease;
  max-height:100vh;
  overflow:hidden;
}

.destaque-card{
  background: linear-gradient(135deg, var(--orange) 0%, #ff9330 100%);
  border-radius:40px;
  padding:40px 60px;
  color:white;
  box-shadow:0 0 30px rgba(0,0,0,0.3);
  animation: brilhar 2s infinite alternate;
  max-height:90vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}

.foto-destaque{
  width:280px;
  height:280px;
  object-fit:cover;
  border-radius:50%;
  border:8px solid white;
  margin:25px 0;
  box-shadow:0 0 25px rgba(255,255,255,0.6);
}

.estrelas{
  font-size:2.4rem;
  color:gold;
  text-shadow:0 0 10px rgba(255,255,255,0.8);
  margin-bottom:8px;
}

.destaque-card h1{
  font-size:3rem;
  margin-bottom:15px;
  text-shadow:0 3px 10px rgba(0,0,0,0.3);
}

.destaque-card h2{
  font-size:2.5rem;
  margin-bottom:15px;
}

.destaque-card p{
  font-size:1.7rem;
  margin-top:10px;
  font-weight:600;
  max-width:90%;
  margin-left:auto;
  margin-right:auto;
  line-height:1.4;
}

/* === 3 NOVAS P√ÅGINAS FULLSCREEN MONITORIA === */
.fullscreen-img-page {
  width: 100%;
  height: 100%;
  display: flex;
  background: black;
}
.fullscreen-img {
  width: 100%;
  height: 100%;
  object-fit: contain; /* troca para cover se quiser preencher tudo */
}

body:active {
  opacity: 0.85;
  transition: opacity 0.15s;
}
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="header-title">
      <img src="logo.png" alt="Logo MC Solu√ß√µes" class="logo-img">
      <div class="logo-dot"></div>
      <div>Painel de Resultados</div>
    </div>
  </header>

  <div class="main" id="main-content">
    <div class="center" id="loading-indicator">Carregando dados...</div>
  </div>

  <div class="footer">MC Solu√ß√µes ¬©</div>
</div>

<script>
/* ------------- CONFIG ------------- */
const fontes = [
  { id: "CREF19", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZt529CoSQvc13l8kopidVIRoEMCHSLFy9A-xJ9Ij440qac25VRLjDjPpskRPBOA/pub?gid=1116505710&single=true&output=csv" },
  { id: "CREF20", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZt529CoSQvc13l8kopidVIRoEMCHSLFy9A-xJ9Ij440qac25VRLjDjPpskRPBOA/pub?gid=195629568&single=true&output=csv" },
  { id: "CREF21", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZt529CoSQvc13l8kopidVIRoEMCHSLFy9A-xJ9Ij440qac25VRLjDjPpskRPBOA/pub?gid=2070528577&single=true&output=csv" },
  { id: "CRTR02", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZt529CoSQvc13l8kopidVIRoEMCHSLFy9A-xJ9Ij440qac25VRLjDjPpskRPBOA/pub?gid=1484490409&single=true&output=csv" },
  { id: "CRTR08", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZt529CoSQvc13l8kopidVIRoEMCHSLFy9A-xJ9Ij440qac25VRLjDjPpskRPBOA/pub?gid=1600799136&single=true&output=csv" },
  { id: "CRTR15", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZt529CoSQvc13l8kopidVIRoEMCHSLFy9A-xJ9Ij440qac25VRLjDjPpskRPBOA/pub?gid=1264950541&single=true&output=csv" },
  { id: "CRN11", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZt529CoSQvc13l8kopidVIRoEMCHSLFy9A-xJ9Ij440qac25VRLjDjPpskRPBOA/pub?gid=1667393760&single=true&output=csv" },
  { id: "AMMV - PIX", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZt529CoSQvc13l8kopidVIRoEMCHSLFy9A-xJ9Ij440qac25VRLjDjPpskRPBOA/pub?gid=1154375239&single=true&output=csv" },
  { id: "AMMV - ENEL", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZt529CoSQvc13l8kopidVIRoEMCHSLFy9A-xJ9Ij440qac25VRLjDjPpskRPBOA/pub?gid=393476796&single=true&output=csv" },
  { id: "STCASA", url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZt529CoSQvc13l8kopidVIRoEMCHSLFy9A-xJ9Ij440qac25VRLjDjPpskRPBOA/pub?gid=808693567&single=true&output=csv" }
];

/* üî• NOVA PLANILHA DAS 3 IMAGENS DA MONITORIA */
const MONITORIA_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vRZt529CoSQvc13l8kopidVIRoEMCHSLFy9A-xJ9Ij440qac25VRLjDjPpskRPBOA/pub?gid=1257542704&single=true&output=csv";

const PAGE_DURATION = 30000;

let cache = {};
let pages = [];
let currentPage = 0;
let destaqueInfo = null;
let monitoriaImgs = [];

/* Convers√£o de link Google Drive */
function convertDrive(url){
  if(!url) return "";
  const match = url.match(/[-\w]{25,}/);
  return match ? `https://lh3.googleusercontent.com/d/${match[0]}` : url;
}

function parseCSV(text){
  const lines = text.split(/\r?\n/);
  const header = lines[0].split(",");
  const data = lines[1].split(",");

  const obj = {};
  for(let i=0;i<header.length;i++){
    obj[header[i]] = data[i] || "";
  }
  return obj;
}

/* ======== carregar imagens das 3 p√°ginas novas ======== */
async function loadMonitoria(){
  try{
    const res = await fetch(MONITORIA_URL);
    const text = await res.text();
    const row = parseCSV(text);

    monitoriaImgs = [
      convertDrive(row.foto_monitoria1),
      convertDrive(row.foto_monitoria2),
      convertDrive(row.foto_monitoria3)
    ];
  }catch(e){
    console.error("Erro ao carregar monitoria:", e);
  }
}

/* (manter tudo que j√° existe no loadAll) */
async function loadAll(){
  await loadMonitoria(); // <<--- adiciona monitoria

  for(const f of fontes){
    const res = await fetch(f.url + "&noCache=" + Date.now());
    const text = await res.text();
    const rows = text.split(/\r?\n/).map(l => l.split(","));
    const header = rows[0];
    const data = rows[1];

    function get(name){
      const idx = header.findIndex(h => h.toLowerCase().includes(name));
      return idx >= 0 ? data[idx] : "0";
    }

    cache[f.id] = {
      meta: Number(get("meta")),
      total: Number(get("total")),
      projPercent: Number(get("proj")),
      lastPay: Number(get("pago"))
    };
  }

  document.getElementById('loading-indicator').style.display = 'none';
  preparePages();
  showPage(0);
  setInterval(nextPage, PAGE_DURATION);
}

function createCard(f){
  const d = cache[f.id];
  const div = document.createElement("div");
  div.className = "card";
  div.innerHTML = `
    <div class="title">${f.id}</div>
    <div class="info">
      <div><strong>Meta M√™s:</strong> R$ ${d.meta.toLocaleString("pt-BR")}</div>
      <div><strong>Valor Total Captado:</strong> R$ ${d.total.toLocaleString("pt-BR")}</div>
      <div><strong>Proje√ß√£o:</strong> ${d.projPercent}%</div>
      <div><strong>Pagos Hoje:</strong> R$ ${d.lastPay.toLocaleString("pt-BR")}</div>
    </div>
  `;
  return div;
}

function preparePages(){
  pages = [
    ["CREF19","CREF20","CREF21"].map(id => createCard(fontes.find(f=>f.id===id))),
    ["CRTR02","CRTR08","CRTR15","CRN11"].map(id => createCard(fontes.find(f=>f.id===id))),
    ["AMMV - PIX","AMMV - ENEL","STCASA"].map(id => createCard(fontes.find(f=>f.id===id))),
  ];

  /* === ‚ûï ADICIONANDO AS 3 NOVAS P√ÅGINAS === */
  monitoriaImgs.forEach(url => {
    if(url && url.trim() !== ""){
      pages.push([
        createFullscreenImgPage(url)
      ]);
    }
  });

}

function createFullscreenImgPage(url){
  const div = document.createElement("div");
  div.className = "fullscreen-img-page";
  div.innerHTML = `<img src="${url}" class="fullscreen-img">`;
  return div;
}

function showPage(idx){
  currentPage = idx;
  const main = document.getElementById("main-content");
  main.innerHTML = "";
  const cards = pages[idx] || [];
  main.style.gridTemplateColumns = `repeat(${cards.length}, 1fr)`;
  cards.forEach(c => main.appendChild(c));
}

function nextPage(){ showPage((currentPage+1)%pages.length); }

/* Refresh autom√°tico */
setInterval(()=> location.reload(), 120000);

document.addEventListener("click", ()=> nextPage());

loadAll();
</script>
</body>
</html>
